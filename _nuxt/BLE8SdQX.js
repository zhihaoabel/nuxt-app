const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./RWS1bgEp.js","./cnz0qvgB.js","./BRg0YUeL.js"])))=>i.map(i=>d[i]);
import{aG as t,aH as n,b as e}from"./cnz0qvgB.js";import{t as r}from"./BRg0YUeL.js";const i=/\d/,o=["-","_","/","."];function s(t=""){if(!i.test(t))return t!==t.toLowerCase()}function a(t,n){const e=o,r=[];if(!t||"string"!=typeof t)return r;let i,a,l="";for(const o of t){const t=e.includes(o);if(!0===t){r.push(l),l="",i=void 0;continue}const n=s(o);if(!1===a){if(!1===i&&!0===n){r.push(l),l=o,i=n;continue}if(!0===i&&!1===n&&l.length>1){const t=l.at(-1);r.push(l.slice(0,Math.max(0,l.length-1))),l=t+o,i=n;continue}}l+=o,i=n,a=t}return r.push(l),r}function l(t,n){return t?(Array.isArray(t)?t:a(t)).map((t=>function(t){return t?t[0].toUpperCase()+t.slice(1):""}((null==n?void 0:n.normalize)?t.toLowerCase():t))).join(""):""}function c(t,n){return t?(Array.isArray(t)?t:a(t)).map((t=>t.toLowerCase())).join("-"):""}const u=(t,n)=>{const e=t._conditions;return e.length>0?`(${e.join(` ${n} `)})`:""},h=t=>{const n=[],e={_conditions:n,where(t,r,i){let o;switch(r.toUpperCase()){case"IN":case"NOT IN":if(!Array.isArray(i))throw new TypeError(`Value for ${r} must be an array`);{const n=i.map((t=>d(t))).join(", ");o=`"${String(t)}" ${r.toUpperCase()} (${n})`}break;case"BETWEEN":case"NOT BETWEEN":if(!Array.isArray(i)||2!==i.length)throw new Error(`Value for ${r} must be an array with two elements`);o=`"${String(t)}" ${r.toUpperCase()} ${d(i[0])} AND ${d(i[1])}`;break;case"IS NULL":case"IS NOT NULL":o=`"${String(t)}" ${r.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":o=`"${String(t)}" ${r.toUpperCase()} ${d(i)}`;break;default:o=`"${String(t)}" ${r} ${d("boolean"==typeof i?Number(i):i)}`}return n.push(`${o}`),e},andWhere(t){const r=t(h());return n.push(u(r,"AND")),e},orWhere(t){const r=t(h());return n.push(u(r,"OR")),e}};return e};function d(t){return`'${String(t).replace(/'/g,"''")}'`}function p(t){return n=>(n=n||{},(t||[]).filter((t=>void 0!==n[t])).reduce(((t,e)=>Object.assign(t,{[e]:n[e]})),{}))}async function f(t,n=[]){var e;const r=t.__params;(null==(e=null==r?void 0:r.orderBy)?void 0:e.length)||(t=t.order("stem","ASC"));const i=await t.orWhere((t=>t.where("navigation","<>","false").where("navigation","IS NULL"))).select("navigation","stem","path","title","meta",...n||[]).all(),{contents:o,configs:s}=i.reduce(((t,n)=>{var e;if(".navigation"===String(n.stem).split("/").pop()){n.title="navigation"===(null==(e=n.title)?void 0:e.toLowerCase())?"":n.title;const r=n.path.split("/").slice(0,-1).join("/")||"/";t.configs[r]={...n,...n.body}}else t.contents.push(n);return t}),{configs:{},contents:[]}),a=t=>({...p(["title",...n])(t),...t.meta,...v(null==t?void 0:t.navigation)?t.navigation:{}}),l=t=>({...p(["title",...n])(t),...v(null==t?void 0:t.navigation)?t.navigation:{}});return g(o.reduce(((t,n)=>{var e;const r=n.path.substring(1).split("/"),i=n.stem.split("/"),o=!!(null==(e=i[i.length-1])?void 0:e.match(/([1-9]\d*\.)?index/g)),c=t=>({title:t.title,path:t.path,stem:t.stem,children:[],...l(t)}),u=c(n);if(o){const e=s[u.path];if(void 0!==(null==e?void 0:e.navigation)&&!1===(null==e?void 0:e.navigation))return t;if("/"!==n.path){const t=c(n);u.children.push(t)}e&&Object.assign(u,a(e))}if(1===r.length){const n=t.find((t=>t.path===u.path&&!1===t.page));return o&&n?Object.assign(n,{page:void 0,children:[...u.children||[],...n.children||[]]}):t.push(u),t}const h=r.slice(0,-1).reduce(((t,n,e)=>{const o="/"+r.slice(0,e+1).join("/"),l=s[o];if(void 0!==(null==l?void 0:l.navigation)&&!1===l.navigation)return[];let c=t.find((t=>t.path===o));if(!c){const r=l?a(l):{};c={...r,title:r.title||m(n),path:o,stem:i.slice(0,e+1).join("/"),children:[],page:!1},t.push(c)}return c.children}),t),d=h.find((t=>t.path===u.path&&!1===t.page));return d?Object.assign(d,{...u,page:void 0,children:[...u.children||[],...d.children||[]]}):h.push(u),t}),[]))}function g(t){var n;const e=t;for(const r of e)(null==(n=r.children)?void 0:n.length)?g(r.children):delete r.children;return t}function v(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}const m=t=>t.split(/[\s-]/g).map(l).join(" ");async function y(t,n,e){const{before:r=1,after:i=1,fields:o=[]}={},s=$(await f(t,o)),a=s.findIndex((t=>t.path===n)),l=-1===a?[]:s.slice(a-r,a),c=-1===a?[]:s.slice(a+1,a+i+1);return[...Array.from({length:r}).fill(null).concat(l).slice(l.length),...c.concat(Array.from({length:i}).fill(null)).slice(0,i)]}function $(t){return t.flatMap((t=>{const n=t.children?$(t.children):[];return!1===t.page||n.length&&n.find((n=>n.path===t.path))?n:[{...t,children:void 0},...n]}))}const S=i=>{var o,s;null==(s=null==(o=n())?void 0:o.ssrContext)||s.event;return((n,e)=>{const i={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},o={__params:i,andWhere(t){const n=t(h());return i.conditions.push(u(n,"AND")),o},orWhere(t){const n=t(h());return i.conditions.push(u(n,"OR")),o},path:n=>o.where("path","=",t(n)),skip:t=>(i.offset=t,o),where:(t,n,e)=>(o.andWhere((r=>r.where(String(t),n,e))),o),limit:t=>(i.limit=t,o),select:(...t)=>(t.length&&i.selectedFields.push(...t),o),order:(t,n)=>(i.orderBy.push(`"${String(t)}" ${n}`),o),all:async()=>e(n,s()).then((t=>t||[])),first:async()=>e(n,s({limit:1})).then((t=>t[0]||null)),count:async(t="*",r=!1)=>e(n,s({count:{field:String(t),distinct:r}})).then((t=>t[0].count))};function s(t={}){let e="SELECT ";if(null==t?void 0:t.count)e+=`COUNT(${t.count.distinct?"DISTINCT ":""}${t.count.field}) as count`;else{const t=Array.from(new Set(i.selectedFields));e+=t.length>0?t.map((t=>`"${String(t)}"`)).join(", "):"*"}e+=` FROM ${r[String(n)]}`,i.conditions.length>0&&(e+=` WHERE ${i.conditions.join(" AND ")}`),i.orderBy.length>0?e+=` ORDER BY ${i.orderBy.join(", ")}`:e+=" ORDER BY stem ASC";const o=(null==t?void 0:t.limit)||i.limit;return o>0&&(i.offset>0?e+=` LIMIT ${o} OFFSET ${i.offset}`:e+=` LIMIT ${o}`),e}return o})(i,((t,n)=>async function(t,n,r){return async function(t,n){const r=await e((()=>import("./RWS1bgEp.js")),__vite__mapDeps([0,1,2]),import.meta.url).then((n=>n.loadDatabaseAdapter(t))).then((t=>t.all(n)));return r}(n,r)}(0,t,n)))};function w(t,n){return j(t,(t=>f(t,n)))}function b(t,n,e){return j(t,(t=>y(t,n)))}function j(t,n){const e=S(t),r={where:(t,n,i)=>(e.where(String(t),n,i),r),andWhere:t=>(e.andWhere(t),r),orWhere:t=>(e.orWhere(t),r),order:(t,n)=>(e.order(String(t),n),r),then:(t,r)=>n(e).then(t,r),catch(t){return this.then(void 0,t)},finally(t){return this.then(void 0,void 0).finally(t)},get[Symbol.toStringTag](){return"Promise"}};return r}export{b as a,w as b,c as k,l as p,S as q};
