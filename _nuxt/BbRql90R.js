import{as as e,C as t,am as a,an as o,r,at as n,ao as s,N as l,e as u,w as i,g as d,J as c,Q as f,O as v,E as p,o as b,c as m,ar as g}from"./cnz0qvgB.js";import{u as I}from"./BBkmFPHu.js";import{u as y}from"./Dl1MLp5C.js";const w={bubbles:!1,cancelable:!0},h={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function F(t,a=!1){const o=e();for(const r of t){if(r===o)return;if(r.focus({preventScroll:a}),e()!==o)return}}const[S,T]=s("RovingFocusGroup"),A=t({__name:"RovingFocusGroup",props:{orientation:{default:void 0},dir:{},loop:{type:Boolean,default:!1},currentTabStopId:{},defaultCurrentTabStopId:{},preventScrollOnEntryFocus:{type:Boolean,default:!1},asChild:{type:Boolean},as:{}},emits:["entryFocus","update:currentTabStopId"],setup(e,{expose:t,emit:s}){const p=e,b=s,{loop:m,orientation:g,dir:y}=a(p),h=I(y),S=o(p,"currentTabStopId",b,{defaultValue:p.defaultCurrentTabStopId,passive:void 0===p.currentTabStopId}),A=r(!1),x=r(!1),C=r(0),{getItems:B,CollectionSlot:R}=n({isProvider:!0});function _(e){const t=!x.value;if(e.currentTarget&&e.target===e.currentTarget&&t&&!A.value){const t=new CustomEvent("rovingFocusGroup.onEntryFocus",w);if(e.currentTarget.dispatchEvent(t),b("entryFocus",t),!t.defaultPrevented){const e=B().map((e=>e.ref)).filter((e=>""!==e.dataset.disabled));F([e.find((e=>""===e.getAttribute("data-active"))),e.find((e=>e.id===S.value)),...e].filter(Boolean),p.preventScrollOnEntryFocus)}}x.value=!1}function K(){setTimeout((()=>{x.value=!1}),1)}return t({getItems:B}),T({loop:m,dir:h,orientation:g,currentTabStopId:S,onItemFocus:e=>{S.value=e},onItemShiftTab:()=>{A.value=!0},onFocusableItemAdd:()=>{C.value++},onFocusableItemRemove:()=>{C.value--}}),(e,t)=>(u(),l(c(R),null,{default:i((()=>[d(c(f),{tabindex:A.value||0===C.value?-1:0,"data-orientation":c(g),as:e.as,"as-child":e.asChild,dir:c(h),style:{outline:"none"},onMousedown:t[0]||(t[0]=e=>x.value=!0),onMouseup:K,onFocus:_,onBlur:t[1]||(t[1]=e=>A.value=!1)},{default:i((()=>[v(e.$slots,"default")])),_:3},8,["tabindex","data-orientation","as","as-child","dir"])])),_:3}))}}),x=t({__name:"RovingFocusItem",props:{tabStopId:{},focusable:{type:Boolean,default:!0},active:{type:Boolean},allowShiftKey:{type:Boolean},asChild:{type:Boolean},as:{default:"span"}},setup(e){const t=e,a=S(),o=y(),r=p((()=>t.tabStopId||o)),s=p((()=>a.currentTabStopId.value===r.value)),{getItems:I,CollectionItem:w}=n();function T(e){if("Tab"===e.key&&e.shiftKey)return void a.onItemShiftTab();if(e.target!==e.currentTarget)return;const o=function(e,t,a){const o=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,a);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(o)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(o)))return h[o]}(e,a.orientation.value,a.dir.value);if(void 0!==o){if(e.metaKey||e.ctrlKey||e.altKey||!t.allowShiftKey&&e.shiftKey)return;e.preventDefault();let s=[...I().map((e=>e.ref)).filter((e=>""!==e.dataset.disabled))];if("last"===o)s.reverse();else if("prev"===o||"next"===o){"prev"===o&&s.reverse();const t=s.indexOf(e.currentTarget);s=a.loop.value?(n=t+1,(r=s).map(((e,t)=>r[(n+t)%r.length]))):s.slice(t+1)}g((()=>F(s)))}var r,n}return b((()=>{t.focusable&&a.onFocusableItemAdd()})),m((()=>{t.focusable&&a.onFocusableItemRemove()})),(e,t)=>(u(),l(c(w),null,{default:i((()=>[d(c(f),{tabindex:s.value?0:-1,"data-orientation":c(a).orientation.value,"data-active":e.active?"":void 0,"data-disabled":e.focusable?void 0:"",as:e.as,"as-child":e.asChild,onMousedown:t[0]||(t[0]=t=>{e.focusable?c(a).onItemFocus(r.value):t.preventDefault()}),onFocus:t[1]||(t[1]=e=>c(a).onItemFocus(r.value)),onKeydown:T},{default:i((()=>[v(e.$slots,"default")])),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])])),_:3}))}});export{h as M,A as _,x as a};
